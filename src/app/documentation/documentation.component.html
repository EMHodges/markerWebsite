<div class="main" #container>

    <mat-card class="example-card"> 
        <h1>Getting Started</h1>
        <mat-card-content>
            <p>Please click the Download button and follow the steps below.
                <div>
                    <b>And remember:</b> 
                </div>
                <ul>
                    <li>
                        Please spend 30 minutes answering the question.
                    </li>
                    <li>
                        Answers are completely anonymous (and really appreciated) so please submit your answers no matter how far you get
                    </li>
                    <li>
                        Upload your submission to this website at the end <i>(details in the 'finished' box below)</i>
                    </li>
                </ul>

        </mat-card-content>
    </mat-card>

    <div *ngIf='(canDownload | async)'>
        <app-download></app-download>
    </div>
    <div *ngIf='(canDownload | async) === false'>

    <mat-card class="example-card" id='running_python_marker' *ngIf="isWindows.value; else run_python_marker_mac">    
        <h2>Running the python marker on Windows</h2>
            <i>on Mac?</i><button mat-raised-button color='accent' (click)="switchWindows()" class="yo">Click Here For Mac</button>
                <mat-card-content>
                    <ul>
                        <li>
                            These instructions are for if you have already downloaded the Python Marker and wish to run it.
                        </li>
                        <li>
                            To download the Python Marker please consent to participating first by<button mat-button color='primary' (click)="navigateToEthics()">clicking here</button>
                        </li>
                    </ul>
                    <ol>
                        <li><b>Navigate to where the python marker was downloaded to</b>
                            <ul>
                                <li>Open File Explorer</li>
                                <li>Navigate to the directory where the python marker was downloaded</li>
                            </ul>

                        </li>
                        <ng-container *ngTemplateOutlet="open_powershell"></ng-container>
                        <ng-container *ngTemplateOutlet="run_python_marker"></ng-container>
                    </ol>
                    <div class = "center">
                        <a href="http://127.0.0.1:8000">
                            <button mat-raised-button color='primary'>Run</button>
                        </a>
                    </div>
                </mat-card-content>
                
    </mat-card>
    </div>

    <mat-card class="example-card" id='using_marker'>
        <h2>Using the Python Marker</h2>
        <mat-card-content>
            Please spend at most <b>30 minutes</b> answering the question.
        </mat-card-content>
        <mat-card-content>
            Do not worry if you do not finish the question or complete all of the parts, please submit your answers to the website anyway. Remember your
            submission is completely anonymous and I'm collecting answers to test the tool, not you!
        </mat-card-content>

        <mat-card-content>
            <b>Opening the question</b>
            <div>Click the <i>Click here to get started!'</i> link on the homepage (<a href="http://127.0.0.1:8000">http://127.0.0.1:800</a>/') to be taken to the question</div>
            <img src="assets/using_python_marker/click_to_get_started.png">
        </mat-card-content>
        <mat-card-content>
            <b>
                Answering the question
            </b>
            <div>
            Type (or paste) your answer into the answer box for each part.
            Click the 'run test & save' button to mark your answer - you can click this as many times as you'd like
            <img src="assets/using_python_marker/run_test.png">
        </div>
        </mat-card-content>
        <mat-card-content>
            When you have finished answering please submit your answers - to do that follow the steps in the 'Finished' box below.
        </mat-card-content>
    </mat-card>

    <mat-card class="example-card" id='using_marker'>
        <h2>Finished</h2>
        <mat-card-content>
        Please submit your answers to this website when you are finished otherwise your answers will not count
        </mat-card-content>
        <mat-card-content>
        To do this please:   
            <ol>
                <li>Scroll to the bottom of the page on the automated marker and locate where it says 'Finished?'
                    <img src="assets/finished/finished.png">
                </li>
                <li>Click the 'Save your answers' button</li>
                <li>Wait for 5 seconds while your answers are saved</li>
                <li>Click the 'Click here to download file' link to create a file containing your answers</li>
                <li>Click the 'Click here to upload file link' or click the button below and follow the instructions to upload your file</li>
            </ol>  
            <div class = "center">
                    <button mat-raised-button color='primary' (click)="navigateToUpload()">Upload</button>
            </div>   
        </mat-card-content>
        
    </mat-card>
</div>



<ng-template #open_powershell>
    <li><b>Open powershell</b>
        <ul>
            <li>
                In File Explorer highlight the text in the address bar (click on the white space to the left of the chevron in the address bar) - the text should turn blue 
                <img src="assets/download_screenshots/chrome/highlight_address_bar.png">
            </li>
            <li>Type 'powershell' and press the 'enter' key to open powershell
                <img src="assets/download_screenshots/chrome/type_powershell.png">
            </li>
        </ul>
    </li>
</ng-template>

<ng-template #run_python_marker>
    <li><b>Run the python marker</b>
        <ul>
            <li>Type the following replacing %downloadID% with the ID of your python-marker (the ID is 6 digits that are in the name of the python marker file you downloaded - e.g. the id for python-marker123456.exe is 123456). Then
                press the enter key.
                <ul>
                    <li><b>.\python-marker%downloadID%.exe runserver --noreload</b>
                        <div>-</div>
                        <div>E.g. for the file python-marker123456.exe, the ID is 123456 so the command is: 
                            <div><i>.\python-marker123456.exe runserver --noreload</i></div></div>
                        <img src="assets/download_screenshots/chrome/powershell_command.png">
                    </li>
                </ul>
            </li>

            <li>Wait until you see some text that looks similar to this:
                <img src="assets/download_screenshots/chrome/powershell_complete.png">
            </li>
            <li>Navigate to <a href='http://127.0.0.1:8000'>'http:127.0.0.1:8000'</a> or click the run button below to open the python marker</li>
        </ul>
    </li>
</ng-template>



<ng-template #run_python_marker_mac>
    <mat-card class="example-card" id='running_python_marker2'>    
        <h2>Running the python marker on Mac</h2>
        <i>on Windows?</i><button mat-raised-button color='accent' (click)="switchMac()" class="yo">Click Here For Windows</button>
        <mat-card-content>

            <ul>
                <li>
                    These instructions are for if you have already downloaded the Python Marker and wish to run it.
                </li>
                <li>
                    To download the Python Marker please consent to participating first by<button mat-button color='primary' (click)="navigateToEthics()">clicking here</button>
                </li>
            </ul>
            <ol>
                <li><b>Setup the Python Marker</b>
                    <ul>
                        <li>Open launchpad and search for <b>terminal</b></li>
                        <li>Click on the terminal icon to open the terminal
                            <img src="assets/mac/terminal.png">
                        </li>
                        <li>Once in the terminal type the following replacing %downloadID% with your download ID - press enter key between each line:
                            <ul>
                                <li><b>cd ~/Downloads</b></li>
                                <li><b>
                                    chmod 777 %downloadID%</b>
                                </li>
                                <li><b>
                                    xattr -dr com.apple.quarantine "%downloadID%"</b>
                                </li>
                            </ul>
                            <br>
                        Your terminal window should look like the below, though with your downloadID instead of python-marker123456: 
                            <img src="assets/mac/mac_command.png">
                        </li>
                    </ul>
                    <br>  
                </li>
                <li><b>Run the python marker</b>
                    <ul>
                        <li>Type (or copy and paste) the following, then press Enter:
                            <ul>
                                <li><b>./%downloadID% runserver --noreload</b></li>
                            </ul>
                        </li>
                        <li>Press Enter key - e.g.
                            <img src="assets/mac/running.png">
                            <i>(replace python-marker123456 with your downloadID)</i>
                        </li>
                        <li>Wait until you see some text that looks similar to this:
                            <img src="assets/mac/text.png">
                        </li>
                        <li>Navigate to <a href='http://127.0.0.1:8000'>'http:127.0.0.1:8000'</a> or click the run button below to open the python marker</li>
                    </ul>
                </li>
            </ol>
            <div class = "center">
                <a href="http://127.0.0.1:8000">
                    <button mat-raised-button color='primary'>Run</button>
                </a>
            </div>
        </mat-card-content>

 
    </mat-card>

</ng-template>