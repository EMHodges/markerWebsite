<div class="main" #container>

    <mat-card class="example-card"> 
        <mat-card-title>Getting Started</mat-card-title>
        <mat-card-content>
            <p>Please click the Download button to download the python marker and follow the steps below. Note it will only run on Windows.</p>
            <button (click)="jumpToSection('running_python_marker')">Running</button>
            <button (click)="jumpToSection('using_marker')">Running</button>

        </mat-card-content>
    </mat-card>

    <div *ngIf='(canDownload | async)'>
        <app-download></app-download>
    </div>
    <div *ngIf='(canDownload | async) === false'>

    <mat-card class="example-card" id='running_python_marker'>    
        <h2>Running the python marker</h2>
        <mat-tab-group mat-align-tabs="start">
            <mat-tab label="Chrome">
                <mat-card-content>
                    <ol>
                        <li><b>Navigate to where the python marker was downloaded to</b>
                            <ul>
                                <li>Open File Explorer</li>
                                <li>Navigate to the directory where the python marker was downloaded</li>
                                <div><i>(If you haven't downloaded the python marker <button mat-button color='primary' (click)="navigateToEthics()">click here</button>)</i></div>
                            </ul>

                        </li>
                        <ng-container *ngTemplateOutlet="open_powershell"></ng-container>
                        <ng-container *ngTemplateOutlet="run_python_marker"></ng-container>
                    </ol>
                    <div class = "center">
                        <a href="http://127.0.0.1:8000">
                            <button mat-raised-button color='primary'>Run</button>
                        </a>
                    </div>
                </mat-card-content>
            </mat-tab>
            <mat-tab label="Microsoft Edge">
                <mat-card-content>
                    <span>Using Chrome is recommended</span>
                    <ol>
                        <li><b>Download the Python Marker</b> 
                            <ul>
                                <li>Click the Download button - do not open the downloaded file 
                                    <div class = "center">
                                        <a href="assets/pythonMarker.exe" download="{{ downloadId }}.exe" (click)="postDownload()">
                                            <button mat-raised-button color='accent' class='download-button'><span>Download</span><fa-icon class="icon" [icon]="faFileDownload" size="2x"></fa-icon></button>
                                        </a>
                                    </div>
                                </li>
                                <li>You should see the downloaded file in the top right 
                                    <img src='assets/download_screenshots/microsoft_edge/warning.png'> 
                                    <div>The warning message is because the file is not known to Microsoft edge - the python marker is not malicious and has been scanned with Microsoft Defender showing no threats</div> 
                                </li>
                                <li>Hover over the download until an ellipsis appears
                                    <img src='assets/download_screenshots/microsoft_edge/more_actions.png'>
                                </li>
                                <li>
                                    Click on the ellipsis and click 'Keep' from the dropdown menu
                                    <img src='assets/download_screenshots/microsoft_edge/keep.png'>
                                </li>
                                <li>This will open a dialog box, click the chevron next to 'Show more' and then click 'Keep anyway'
                                    <img src='assets/download_screenshots/microsoft_edge/keep_anyway.png'>  
                                </li>
                                <li>Now you should be able to see the file without a warning. Click on the file icon to open File Explorer
                                    <img src='assets/download_screenshots/microsoft_edge/show_in_folder.png'>
                                </li>
                            </ul>
                        </li>
                        <ng-container *ngTemplateOutlet="open_powershell"></ng-container>
                        <ng-container *ngTemplateOutlet="run_python_marker"></ng-container>
                    </ol>
                    <div class = "center">
                        <a href="http://127.0.0.1:8000">
                            <button mat-raised-button color='primary'>Run</button>
                        </a>
                    </div>
                </mat-card-content>


            </mat-tab>
            <mat-tab label="Firefox"></mat-tab>
          </mat-tab-group>
    </mat-card>
    </div>
    <mat-card class="example-card" id='using_marker'>
        <h1>Using it</h1>
    </mat-card>
</div>



<ng-template #open_powershell>
    <li><b>Open powershell</b>
        <ul>
            <li>
                In File Explorer highlight the text in the address bar (click on the white space to the left of the chevron in the address bar) - the text should turn blue 
                <img src="assets/download_screenshots/chrome/highlight_address_bar.png">
            </li>
            <li>Type 'powershell' and press the 'enter' key to open powershell
                <img src="assets/download_screenshots/chrome/type_powershell.png">
            </li>
        </ul>
    </li>
</ng-template>

<ng-template #run_python_marker>
    <li><b>Run the python marker</b>
        <ul>
            <li>Type <b>'.\{{downloadId}}.exe runserver --noreload'</b> and press enter key 
                <img src="assets/download_screenshots/chrome/powershell_command.png">
                <i>(replace .\python-marker123456 with .\{{downloadId}})</i>
            </li>
            <li>Wait until you see some text that looks similar to this:
                <img src="assets/download_screenshots/chrome/powershell_complete.png">
            </li>
            <li>Navigate to <a href='http://127.0.0.1:8000'>'http:127.0.0.1:8000'</a> or click the run button below to open the python marker</li>
        </ul>
    </li>
</ng-template>